<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>README - RDoc Documentation</title>

  <meta name="keywords" content="ruby,documentation,README">
  <meta name="description" content="README: github. github.">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<div id="navigation-toggle" role="button" tabindex="0" aria-label="Toggle sidebar" aria-expanded="true" aria-controls="navigation">
  <span aria-hidden="true">&#9776;</span>
</div>


<nav id="navigation" role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>



  <ul class="link-list" role="directory">
              <li>
            <details open>
              <summary>      <a href="#label-dependabot-linguist"><a href="https://github.com/Skenvy/dependabot-linguist">dependabot-linguist</a></a>
</summary>
              <ul class="link-list" role="directory">
                          <li>
            <details open>
              <summary>      <a href="#label-Getting+Started">Getting Started</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Linguist+dependencies-3B"><a href="https://github.com/github/linguist#dependencies">Linguist dependencies</a>;</a>
          <li>      <a href="#label-Dependabot+dependencies-3B">Dependabot dependencies;</a>
          <li>      <a href="#label-Install+this">Install <em>this</em></a>
          <li>      <a href="#label-Or+add+to+the+Gemfile">Or add to the Gemfile</a>
          <li>      <a href="#label-Setup+external+CLIs">Setup external CLIs</a>

              </ul>
            </details>
          </li>
          <li>
            <details open>
              <summary>      <a href="#label-Usage">Usage</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Use+the+classes+in+a+ruby+script-2C+with+defaults">Use the classes in a ruby script, with defaults</a>
          <li>      <a href="#label-Use+the+CLI">Use the CLI</a>
          <li>
            <details open>
              <summary>      <a href="#label-Configure">Configure</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>
            <details open>
              <summary>      <a href="#label-ignore"><code>ignore</code></a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-directory"><code>directory</code></a>
          <li>      <a href="#label-ecosystem"><code>ecosystem</code></a>

              </ul>
            </details>
          </li>

              </ul>
            </details>
          </li>

              </ul>
            </details>
          </li>
          <li>      <a href="#label-RDoc+generated+docs"><a href="https://skenvy.github.io/dependabot-linguist/">RDoc generated docs</a></a>
          <li>
            <details open>
              <summary>      <a href="#label-Developing">Developing</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Install+Ruby">Install Ruby</a>
          <li>      <a href="#label-Install+Corepack">Install Corepack</a>

              </ul>
            </details>
          </li>

              </ul>
            </details>
          </li>

  </ul>
</div>

  
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="./README_md.html">README</a>
  </ul>
</div>


  <footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.13.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

</nav>

<main role="main" aria-label="Page README.md">

<h1 id="label-dependabot-linguist"><a href="https://github.com/Skenvy/dependabot-linguist">dependabot-linguist</a><span><a href="#label-dependabot-linguist">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>Use <a href="https://github.com/github/linguist">linguist</a> to check the contents of a <strong>local</strong> repository, and then scan for <a href="https://github.com/dependabot/dependabot-core">dependabot-core</a> ecosystems relevant to those languages! With the list of <a href="https://docs.github.com/en/code-security/dependabot/dependabot-version-updates/configuration-options-for-the-dependabot.yml-file#package-ecosystem">ecosystems</a> present in a repository, add a <a href="https://docs.github.com/en/code-security/dependabot/dependabot-security-updates/configuring-dependabot-security-updates">dependabot.y[a]ml</a> (<a href="https://docs.github.com/en/code-security/dependabot/dependabot-version-updates/configuration-options-for-the-dependabot.yml-file">configuration file</a>).</p>

<h2 id="label-Getting+Started">Getting Started<span><a href="#label-Getting+Started">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Linguist+dependencies-3B"><a href="https://github.com/github/linguist#dependencies">Linguist dependencies</a>;<span><a href="#label-Linguist+dependencies-3B">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Before installing this gem, which will install the <a href="https://rubygems.org/gems/github-linguist">github-linguist gem</a>, linguists dependencies should be installed. A number of these are enabling <a href="https://rubygems.org/gems/rugged">rugged</a>, so they can’t be “ignored” like <a href="https://github.com/dependabot/dependabot-core#setup">dependabot’s setup</a>, which <em>can</em> be ignored for the purpose of <strong>this</strong> gem, which only intends to use the <a href="https://github.com/dependabot/dependabot-core/blob/v0.303.0/common/lib/dependabot/file_fetchers/README.md">file fetchers</a>.</p>

<pre>sudo apt-get install build-essential cmake pkg-config libicu-dev zlib1g-dev libcurl4-openssl-dev libssl-dev ruby-dev</pre>

<h3 id="label-Dependabot+dependencies-3B"><a href="Dependabot.html"><code>Dependabot</code></a> dependencies;<span><a href="#label-Dependabot+dependencies-3B">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>npm</code>/<code>yarn</code> module requires {<code>corepack</code><a href="https://www.npmjs.com/package/corepack">}</a>, so it will be necessary to install, either with npm or yarn. Ensuring you have the <em>right version</em> of <code>corepack</code> is important. Your best bet is to ensure you have the latest version.</p>

<pre>nvm install 22 &amp;&amp; nvm use 22 &amp;&amp; npm i -g corepack@latest
# you&#39;ll need to `nvm use 22` to load that node before running this gem</pre>

<h3 id="label-Install+this">Install <em>this</em><span><a href="#label-Install+this">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p><a href="https://rubygems.org/gems/dependabot-linguist">To install the latest from RubyGems</a>;</p>

<pre class="ruby"><span class="ruby-identifier">gem</span> <span class="ruby-identifier">install</span> <span class="ruby-identifier">dependabot</span><span class="ruby-operator">-</span><span class="ruby-identifier">linguist</span>
</pre>

<p><a href="https://github.com/Skenvy/dependabot-linguist/packages/1704407">Or to install from GitHub’s hosted gems</a>;</p>

<pre>gem install dependabot-linguist --source &quot;https://rubygems.pkg.github.com/skenvy&quot;</pre>

<h3 id="label-Or+add+to+the+Gemfile">Or add to the Gemfile<span><a href="#label-Or+add+to+the+Gemfile">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p><a href="https://rubygems.org/gems/dependabot-linguist">Add the RubyGems hosted gem</a> with bundler;</p>

<pre class="ruby"><span class="ruby-identifier">bundle</span> <span class="ruby-identifier">add</span> <span class="ruby-identifier">dependabot</span><span class="ruby-operator">-</span><span class="ruby-identifier">linguist</span>
</pre>

<p>Or add the following line to your <code>Gemfile</code> manually</p>

<pre class="ruby"><span class="ruby-identifier">gem</span> <span class="ruby-string">&quot;dependabot-linguist&quot;</span>, <span class="ruby-string">&quot;&gt;= 0.303.0</span>
</pre>

<p><a href="https://github.com/Skenvy/dependabot-linguist/packages/1704407">Add the GitHub hosted gem</a>;</p>

<pre class="ruby"><span class="ruby-identifier">source</span> <span class="ruby-string">&quot;https://rubygems.pkg.github.com/skenvy&quot;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">gem</span> <span class="ruby-string">&quot;dependabot-linguist&quot;</span>, <span class="ruby-string">&quot;&gt;= 0.303.0&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<h3 id="label-Setup+external+CLIs">Setup external CLIs<span><a href="#label-Setup+external+CLIs">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you intend to use <a href="Dependabot/Linguist/DependabotFileValidator.html#method-i-commit_new_config"><code>::Dependabot::Linguist::DependabotFileValidator.commit_new_config</code></a>, you’ll need to also setup the {<code>gh</code><a href="https://cli.github.com/manual/">}</a> CLI. You can follow instructions on <a href="https://github.com/cli/cli">cli/cli</a> to install it, which for the intended use case should be <a href="https://github.com/cli/cli/blob/trunk/docs/install_linux.md">this guide</a>. Once you’ve installed it, <a href="https://cli.github.com/manual/gh_auth_login">you’ll need to log in</a> prior to running this script, as the credentials are expected to already be in place.</p>

<p>It also expects <code>git</code> to be installed and credentialed, for pushing the branch.</p>

<h2 id="label-Usage">Usage<span><a href="#label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The two main classes this provides, <a href="Dependabot/Linguist/Repository.html"><code>::Dependabot::Linguist::Repository</code></a> and <a href="Dependabot/Linguist/DependabotFileValidator.html"><code>::Dependabot::Linguist::DependabotFileValidator</code></a>, can be utilised independently, although the intention is that they be utilised together; to discover the contents of a repository that should be watched with a dependabot file by <code>Repository</code>, and subsequently using <code>DependabotFileValidator</code> to edit an existing, or add a new, dependabot file to watch the directories that were validated earlier. There is also a CLI tool, <code>dependabot-linguist</code>, that wraps these classes and surfaces all the available options to them, although adding automated tests for the executable is still a TODO.</p>

<p>The intended end goal is to use this to automatically raise a PR on GitHub with the recommended changes to the <code>~/.github/dependabot.y[a]ml</code> file. This is performed by <a href="Dependabot/Linguist/DependabotFileValidator.html#method-i-commit_new_config"><code>::Dependabot::Linguist::DependabotFileValidator.commit_new_config</code></a>, which utilises Ruby’s <code>Kernel</code> to run commands in an external shell that perform actions using the <code>gh</code> cli, and <code>git</code>. If you intend to use these you’ll want to follow <a href="https://github.com/Skenvy/dependabot-linguist#setup-external-clis">Setup external CLIs</a>.</p>

<h3 id="label-Use+the+classes+in+a+ruby+script-2C+with+defaults">Use the classes in a ruby script, with defaults<span><a href="#label-Use+the+classes+in+a+ruby+script-2C+with+defaults">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&quot;dependabot/linguist&quot;</span>
<span class="ruby-comment"># Get the list of directories validated for each ecosystem.</span>
<span class="ruby-ivar">@repo_path</span> = <span class="ruby-string">&quot;.&quot;</span> <span class="ruby-comment"># &quot;here&quot;</span>
<span class="ruby-ivar">@repo_name</span> = <span class="ruby-string">&quot;Skenvy/dependabot-linguist&quot;</span> <span class="ruby-comment"># If it were evaluating this repo!</span>
<span class="ruby-ivar">@this_repo</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Dependabot</span><span class="ruby-operator">::</span><span class="ruby-constant">Linguist</span><span class="ruby-operator">::</span><span class="ruby-constant">Repository</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@repo_path</span>, <span class="ruby-ivar">@repo_name</span>)
<span class="ruby-ivar">@this_repo</span>.<span class="ruby-identifier">directories_per_ecosystem_validated_by_dependabot</span>
<span class="ruby-comment"># Use this list to see what the recommended update to the existing (or add new) config is.</span>
<span class="ruby-ivar">@validator</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Dependabot</span><span class="ruby-operator">::</span><span class="ruby-constant">Linguist</span><span class="ruby-operator">::</span><span class="ruby-constant">DependabotFileValidator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">repo_path</span>)
<span class="ruby-ivar">@validator</span>.<span class="ruby-identifier">load_ecosystem_directories</span>(<span class="ruby-value">incoming:</span> <span class="ruby-ivar">@this_repo</span>.<span class="ruby-identifier">directories_per_ecosystem_validated_by_dependabot</span>)
<span class="ruby-ivar">@validator</span>.<span class="ruby-identifier">new_config</span>
<span class="ruby-comment"># If you trust it to write the new config;</span>
<span class="ruby-ivar">@validator</span>.<span class="ruby-identifier">write_new_config</span>
<span class="ruby-comment"># If you have git, and the gh cli tool installed and configured, and trust this</span>
<span class="ruby-comment"># tool to handle branching, commiting, pushing, and raising a pull request;</span>
<span class="ruby-ivar">@validator</span>.<span class="ruby-identifier">commit_new_config</span>
</pre>

<h3 id="label-Use+the+CLI">Use the CLI<span><a href="#label-Use+the+CLI">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you installed this with <strong>bundler</strong>, you’ll need to preface these with <code>bundle exec</code>.</p>

<pre># With no flags, it&#39;ll run &quot;here&quot;, and print out the recommended new config.
dependabot-linguist
# With -w, it&#39;ll write the file. You can also specify a path.
dependabot-linguist ../../some/other/repo -w
# With -x, you&#39;ll be trusting it to raise a pull request of the recommended config.
# You can also specify a name, which will be required if there isn&#39;t a &quot;origin&quot; remote.
dependabot-linguist ../../some/other/repo Username/Reponame -x</pre>

<h3 id="label-Configure">Configure<span><a href="#label-Configure">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>A yaml config file can be placed at <code>~/.github/.dependabot-linguist</code>. See this <a href="https://github.com/Skenvy/dependabot-linguist/blob/main/.github/.dependabot-linguist">example</a>. Although it’s a dotfile, it’ll be read by rugged, so for it to be utilised it should be checked in. The options available to this configuration file currently are;</p>

<h4 id="label-ignore"><code>ignore</code><span><a href="#label-ignore">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The below options, <code>directory</code> and <code>ecosystem</code> are not mutually exclusive, and can be mixed, according to what top level catagorisation requires less verbose configuration, if you want to ignore many directories for one or two ecosystems, or many ecosystems for one or two directories!</p>

<h5 id="label-directory"><code>directory</code><span><a href="#label-directory">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>To ignore some ecosystems per directory, you can add</p>

<pre>ignore:
  directory:
    /path/to/somewhere:
    - some_ecosystem</pre>

<h5 id="label-ecosystem"><code>ecosystem</code><span><a href="#label-ecosystem">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>To ignore some directories per ecosystem, you can add</p>

<pre>ignore:
  ecosystem:
    some_other_ecosystem:
    - /path/to/somewhere_else</pre>

<h2 id="label-RDoc+generated+docs"><a href="https://skenvy.github.io/dependabot-linguist/">RDoc generated docs</a><span><a href="#label-RDoc+generated+docs">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h2 id="label-Developing">Developing<span><a href="#label-Developing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Install+Ruby">Install Ruby<span><a href="#label-Install+Ruby">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>You will need to install <a href="https://rvm.io/">rvm</a> and one of its <a href="https://rvm.io/binaries/">ruby binaries</a>.</p>

<p>You’ll also need to set the <code>RVM_DIR</code> in your shell profile e.g. <a href="https://github.com/Skenvy/dotfiles/blob/1de61272c588a30b634a03a7d304ef51e40c72f1/.bash_login#L17">like this</a>. RVM will set some basic initialisation in your shell profile, but changing what it sets to instead use <code>RVM_DIR</code> like this allows you to install it somewhere other than the default.</p>

<p>The <code>make setup</code> in <a href="#the-first-time-setup">first time setup</a> will install the intended development version for you, but it might not be a precompiled binary, depending on your OS and architecture ~ if it isn’t precompiled, contributing your time in compiling to <a href="https://github.com/rvm/rvm/issues/4921">publish the binary for rvm</a> is probably more worth your time than this lol.</p>

<p>RVM is locally how we manage proctoring the ruby environment. It is not on the <a href="https://github.com/actions/runner-images">github runners</a>, so the make invocations in the workflows set the RVM proctors empty. If you want to manage your own ruby installs you can set <code>_=&#39;&#39;</code> on each <code>make ...</code>.</p>

<p>You should also read the requirements for the gems this uses, see <a href="#linguist-dependencies">Linguist dependencies</a> and <a href="#dependabot-dependencies">Dependabot dependencies</a>. <a href="Linguist.html"><code>Linguist</code></a>‘s can be acquired with <code>make preinit</code> done once.</p>

<h3 id="label-Install+Corepack">Install Corepack<span><a href="#label-Install+Corepack">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p><a href="#dependabot-dependencies">Dependabot dependencies</a> are managed in this project via {<code>nvm</code><a href="https://github.com/nvm-sh/nvm">}</a>, so <code>corepack</code> can be loaded into every subshell the <code>Makefile</code> spawns. If you don’t want to install <code>nvm</code> but would rather manage your own <code>corepack</code> install, set <code>__=&#39;&#39;</code> on each <code>make ...</code>.</p>

<p>For the currently targetted version of <code>dependabot</code> that this is using, the existing reference versions of <code>corepack</code> are; * <a href="https://github.com/dependabot/dependabot-core/blob/v0.303.0/bun/Dockerfile#L4">bun/Dockerfile</a> * <a href="https://github.com/dependabot/dependabot-core/blob/v0.303.0/npm_and_yarn/Dockerfile#L4">npm_and_yarn/Dockerfile</a></p>

<p>Both currently (as of writing) set their <code>corepack</code> version to <code>0.31.0</code>. However, it’s possible for the changes in versions in <code>corepack</code> to outstrip the rate of changes of this gem, so don’t rely on <em>this</em> to determine what the most suitable version of <code>corepack</code> is.</p>

<blockquote>
<p>[!CAUTION] <code>make setup</code> / <code>initialise</code> / <code>initialise_corepack</code> will install to your <em>global</em> <code>node</code>. If you’re using the recommended <code>nvm</code> then each <code>node</code> install can be treated eseentially ephemeral. If you aren’t using <code>nvm</code>, this might hijack your global <code>corepack</code> install.</p>

<h3 id="label-The+first+time+setup">The first time setup<span><a href="#label-The+first+time+setup">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you have <code>rvm</code> and <code>nvm</code> installed and you have <code>apt</code>, you should be able to;</p>

<pre>git clone https://github.com/Skenvy/dependabot-linguist.git &amp;&amp; cd dependabot-linguist &amp;&amp; make preinit &amp;&amp; make setup</pre>

<h3 id="label-Iterative+development">Iterative development<span><a href="#label-Iterative+development">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The majority of <code>make</code> recipes for this are just wrapping a <code>bundle</code> invocation of <code>rake</code>. * <code>make docs</code> will recreate the RDoc docs * <code>make test</code> will run the RSpec tests. * <code>make lint</code> will run the RuboCop linter.</p>
</blockquote>

</main>

